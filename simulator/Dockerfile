# ----------------------------------------------------
# 1. Use a lightweight Node.js image
# ----------------------------------------------------
FROM node:20-alpine

# ----------------------------------------------------
# 2. Set the working directory inside the container
# ----------------------------------------------------
WORKDIR /app

# ----------------------------------------------------
# 3. Copy only package.json first (for better caching)
# ----------------------------------------------------
COPY package.json package-lock.json* ./

# ----------------------------------------------------
# 4. Install dependencies
# ----------------------------------------------------
RUN npm install --production

# ----------------------------------------------------
# 5. Copy the source code
# ----------------------------------------------------
COPY src ./src

# ----------------------------------------------------
# 6. Copy environment file (optional)
# ----------------------------------------------------
COPY .env .env

# ----------------------------------------------------
# 7. Default command to start the simulator
# ----------------------------------------------------
CMD ["npm", "start"]
